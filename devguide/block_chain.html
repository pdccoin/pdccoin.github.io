
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="description" content="This site aims to provide the docs
                you need to understand Pandora and start building Pandora-based
                applications." />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta property="og:title" content="Block Chain &#8212; Pandora" />
    <meta property="og:description" content="This site aims to provide the
    docs you need to understand Pandora and start building Pandora-based
    applications." />
    <meta property="og:image" content="https://developer.pandora.org/static/pandoradocs.png" />
    <meta property="og:type" content="website" />
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:400,700&display=swap" rel="stylesheet">
    
    <title>Block Chain &#8212; Pandora</title>

    <link rel="stylesheet" href="../static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/sphinxbootstrap4.css" type="text/css" />
    <link rel="stylesheet" href="../static/bootstrap-4.3.1-dist/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../static/css/main.css" />
    
    <script id="documentation_options" data-url_root="../" src="../static/documentation_options.js"></script>
    <script src="../static/jquery.js"></script>
    <script src="../static/underscore.js"></script>
    <script src="../static/doctools.js"></script>
    <script src="../static/language_data.js"></script>
    <script src="../static/js/jquery.qrcode.js"></script>
    <script type="text/javascript" src="../static/bootstrap-4.3.1-dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../static/sphinxbootstrap4.js"></script>
    <link rel="shortcut icon" href="../static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Transactions" href="transactions.html" />
    <link rel="prev" title="Developer Guides" href="index.html" /> 
  </head><body>
  
<nav class="navbar navbar-expand-md  fixed-top navbar-dark">
		<div class="content-container d-flex flex-wrap">
			<a class="navbar-brand py-1" href="../index.html">
				<div class="header-logo">
					<div class="logo-light"></div>
				</div>
			</a>
			<button class="navbar-toggler navbar-dark ml-auto py-2 black" type="button" data-toggle="collapse"
				data-target="#exCollapsingNavbar2">
				&#9776;
			</button>
			<div class="navbar-collapse collapse" id="exCollapsingNavbar2">
				<ul class="navbar-nav mr-auto">
					
				</ul>
				<div class="dropdown-divider d-block d-md-none my-3"></div>
				
<form class="form-inline navbar-search" action="../search.html" method="get">
  <input type="text" name="q" class="navbar-search-input form-control" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>

			</div>
		</div>
	
		<!--<div class="row hidden-sm-up">
						<div class="collapse navbar-toggleable-xs container" id="exCollapsingNavbar2">
								<div class="container">
								　　 <a class="navbar-brand" href="../index.html">
												Pandora
										</a>
								</div>
								<ul class="nav navbar-nav">
								</ul>
								<div class="dropdown-divider"></div>
								<div class="navbar-text">search<div>
								
<form class="form-inline navbar-search" action="../search.html" method="get">
  <input type="text" name="q" class="navbar-search-input form-control" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>

						</div>
				</div>-->
</nav>
</div>

  
  <div class="breadcrumbs-section" role="navigation" aria-label="related navigation">
	<div class="content-container">
		<div class="d-flex justify-content-between flex-wrap">
			<ol class="breadcrumb">
				<li class="breadcrumb-item">
					<a href="../index.html">Pandora</a>
				</li>
				<li class="breadcrumb-item">
					<a href="index.html"  accesskey="U" class="active" >Developer Guides</a>
				</li>
				<li class="breadcrumb-item active">Block Chain</li>
			</ol>

			<div class="btn-group btn-group-sm" role="group" aria-label="Basic example">
				<a href="index.html" title="Previous Chapter: Developer Guides" class="btn btn-primary"
					role="botton" accesskey="P">
					&laquo; Developer Guides
				</a>
				<a href="transactions.html" title="Next Chapter: Transactions" class="btn btn-primary"
					role="botton" accesskey="N">
					Transactions &raquo;
				</a>
			</div>
		</div>
	</div>
</div>

  <div class="main container-fluid">
    <div class="content-container">
      <div class="row"> 
  
      <div class="sphinxsidebar d-none d-md-block">
        <div class="sphinxsidebarwrapper">          
            <h4>Table Of Contents</h4>
            
            
              <div class="sidebartoctree">
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Guides</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="block_chain.html#">Block Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="transactions.html">Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="contracts.html">Contracts</a></li>
<li class="toctree-l2"><a class="reference internal" href="wallets.html">Wallets</a></li>
<li class="toctree-l2"><a class="reference internal" href="payment_processing.html">Payment Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="operating_modes.html">Operating Modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="p2p_network.html">P2P Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="mining.html">Mining</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/block_chain.html">Block Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/transactions.html">Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/wallets.html">Wallets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/p2p_networking.html">P2P Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/rpc/index.html">RPC API Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/testing.html">Testing Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/transactions.html">Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/payment_processing.html">Payment Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/p2p_networking.html">P2P Network</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

              </div>
            
          
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Developer Guides</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="transactions.html"
                        title="next chapter">Transactions</a></p>
















  <div>
    <h4>Contribute</h4>
    <p class="topless">
      <a href="https://github.com/pdccoin-documentation/website/blob/master/devguide/block_chain.rst">Edit Page</a>
    </p>
  </div>
        </div>
      </div>
       
  
        <div class="document">
        <div class="documentwrapper">
          <div class="bodywrapper">
            <div class="body">
              
  <div class="section" id="block-chain">
<h1>Block Chain<a class="headerlink" href="block_chain.html#block-chain" title="Permalink to this headline">¶</a></h1>
<p>The block chain provides Pandora’s public ledger, an ordered and timestamped record of transactions. This system is used to protect against double spending and modification of previous transaction records.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="block_chain.html#introduction" title="Permalink to this headline">¶</a></h2>
<p>Each full node in the Pandora <a class="reference external" href="p2p_network.html">network</a> independently stores a block chain containing only blocks validated by that node. When several nodes all have the same blocks in their block chain, they are considered to be in <a class="reference internal" href="../glossary.html#term-Consensus"><span class="xref std std-term">consensus</span></a>. The validation rules these nodes follow to maintain consensus are called <a class="reference internal" href="../glossary.html#term-Consensus-rules"><span class="xref std std-term">consensus rules</span></a>. This section describes many of the consensus rules used by Pandora Core.</p>
<div class="figure align-default" id="id1">
<img alt="Block Chain Overview" src="../images/en-blockchain-overview.svg" /><p class="caption"><span class="caption-text">Block Chain Overview</span><a class="headerlink" href="block_chain.html#id1" title="Permalink to this image">¶</a></p>
</div>
<p>The illustration above shows a simplified version of a block chain. A <a class="reference internal" href="../glossary.html#term-Block"><span class="xref std std-term">block</span></a> of one or more new transactions is collected into the transaction data part of a block. Copies of each transaction are hashed, and the hashes are then paired, hashed, paired again, and hashed again until a single hash remains, the <a class="reference internal" href="../glossary.html#term-Merkle-root"><span class="xref std std-term">merkle root</span></a> of a merkle tree.</p>
<p>The merkle root is stored in the block header. Each block also stores the hash of the previous block’s header, chaining the blocks together. This ensures a transaction cannot be modified without modifying the block that records it and all following blocks.</p>
<p>Transactions are also chained together. Pandora wallet software gives the impression that satoshis are sent from and to wallets, but pandoras really move from transaction to transaction. Each transaction spends the satoshis previously received in one or more earlier transactions, so the input of one transaction is the output of a previous transaction.</p>
<div class="figure align-default" id="id2">
<img alt="Transaction Propagation" src="../images/en-transaction-propagation.svg" /><p class="caption"><span class="caption-text">Transaction Propagation</span><a class="headerlink" href="block_chain.html#id2" title="Permalink to this image">¶</a></p>
</div>
<p>A single transaction can create multiple outputs, as would be the case when sending to multiple addresses, but each output of a particular transaction can only be used as an input once in the block chain. Any subsequent reference is a forbidden double spend—an attempt to spend the same satoshis twice.</p>
<p>Outputs are tied to <a class="reference internal" href="../glossary.html#term-Txid"><span class="xref std std-term">transaction identifiers (TXIDs)</span></a>, which are the hashes of signed transactions.</p>
<p>Because each output of a particular transaction can only be spent once, the outputs of all transactions included in the block chain can be categorized as either <a class="reference internal" href="../glossary.html#term-UTXO"><span class="xref std std-term">Unspent Transaction Outputs (UTXOs)</span></a> or spent transaction outputs. For a payment to be valid, it must only use UTXOs as inputs.</p>
<p>Ignoring coinbase transactions (described later), if the value of a transaction’s outputs exceed its inputs, the transaction will be rejected—but if the inputs exceed the value of the outputs, any difference in value may be claimed as a <a class="reference internal" href="../glossary.html#term-Transaction-fee"><span class="xref std std-term">transaction fee</span></a> by the Pandora <a class="reference internal" href="../glossary.html#term-Mining"><span class="xref std std-term">miner</span></a> who creates the block containing that transaction. For example, in the illustration above, each transaction spends 10,000 satoshis fewer than it receives from its combined inputs, effectively paying a 10,000 satoshi transaction fee.</p>
</div>
<div class="section" id="proof-of-work">
<h2>Proof Of Work<a class="headerlink" href="block_chain.html#proof-of-work" title="Permalink to this headline">¶</a></h2>
<p>The block chain is collaboratively maintained by anonymous peers on the <a class="reference external" href="p2p_network.html">network</a>, so Pandora requires that each block prove a significant amount of work was invested in its creation to ensure that untrustworthy peers who want to modify past blocks have to work harder than honest peers who only want to add new blocks to the block chain.</p>
<p>Chaining blocks together makes it impossible to modify transactions included in any block without modifying all subsequent blocks. As a result, the cost to modify a particular block increases with every new block added to the block chain, magnifying the effect of the proof of work.</p>
<p>The <a class="reference internal" href="../glossary.html#term-Proof-of-work"><span class="xref std std-term">proof of work</span></a> used in Pandora takes advantage of the apparently random nature of cryptographic hashes. A good cryptographic hash algorithm converts arbitrary data into a seemingly random number. If the data is modified in any way and the hash re-run, a new seemingly random number is produced, so there is no way to modify the data to make the hash number predictable.</p>
<p>To prove you did some extra work to create a block, you must create a hash of the block header which does not exceed a certain value. For example, if the maximum possible hash value is 2256 − 1, you can prove that you tried up to two combinations by producing a hash value less than 2255.</p>
<p>In the example given above, you will produce a successful hash on average every other try. You can even estimate the probability that a given hash attempt will generate a number below the <a class="reference internal" href="../glossary.html#term-nBits"><span class="xref std std-term">target</span></a> threshold. Pandora assumes a linear probability that the lower it makes the target threshold, the more hash attempts (on average) will need to be tried.</p>
<p>New blocks will only be added to the block chain if their hash is at least as challenging as a <a class="reference internal" href="../glossary.html#term-Difficulty"><span class="xref std std-term">difficulty</span></a> value expected by the consensus protocol. Every 2,016 blocks, the <a class="reference external" href="p2p_network.html">network</a> uses timestamps stored in each block header to calculate the number of seconds elapsed between generation of the first and last of those last 2,016 blocks. The ideal value is 1,209,600 seconds (two weeks).</p>
<ul class="simple">
<li><p>If it took fewer than two weeks to generate the 2,016 blocks, the expected difficulty value is increased proportionally (by as much as 300%) so that the next 2,016 blocks should take exactly two weeks to generate if hashes are checked at the same rate.</p></li>
<li><p>If it took more than two weeks to generate the blocks, the expected difficulty value is decreased proportionally (by as much as 75%) for the same reason.</p></li>
</ul>
<p>(Note: an off-by-one error in the Pandora Core implementation causes the difficulty to be updated every 2,01<em>6</em> blocks using timestamps from only 2,01<em>5</em> blocks, creating a slight skew.)</p>
<p>Because each block header must hash to a value below the target threshold, and because each block is linked to the block that preceded it, it requires (on average) as much hashing power to propagate a modified block as the entire Pandora <a class="reference external" href="p2p_network.html">network</a> expended between the time the original block was created and the present time. Only if you acquired a majority of the <a class="reference external" href="p2p_network.html">network’s</a> hashing power could you reliably execute such a <a class="reference internal" href="../glossary.html#term-51-percent-attack"><span class="xref std std-term">51 percent attack</span></a> against transaction history (although, it should be noted, that even less than 50% of the hashing power still has a good chance of performing such attacks).</p>
<p>The block header provides several easy-to-modify fields, such as a dedicated nonce field, so obtaining new hashes doesn’t require waiting for new transactions. Also, only the 80-byte block header is hashed for proof-of-work, so including a large volume of transaction data in a block does not slow down hashing with extra I/O, and adding additional transaction data only requires the recalculation of the ancestor hashes in the merkle tree.</p>
</div>
<div class="section" id="block-height-and-forking">
<h2>Block Height And Forking<a class="headerlink" href="block_chain.html#block-height-and-forking" title="Permalink to this headline">¶</a></h2>
<p>Any Pandora miner who successfully hashes a block header to a value below the target threshold can add the entire block to the block chain (assuming the block is otherwise valid). These blocks are commonly addressed by their <a class="reference internal" href="../glossary.html#term-Block-height"><span class="xref std std-term">block height</span></a>—the number of blocks between them and the first Pandora block (block 0, most commonly known as the <a class="reference internal" href="../glossary.html#term-Genesis-block"><span class="xref std std-term">genesis block</span></a>). For example, block 2016 is where difficulty could have first been adjusted.</p>
<div class="figure align-default" id="id3">
<img alt="Common And Uncommon Block Chain Forks" src="../images/en-blockchain-fork.svg" /><p class="caption"><span class="caption-text">Common And Uncommon Block Chain Forks</span><a class="headerlink" href="block_chain.html#id3" title="Permalink to this image">¶</a></p>
</div>
<p>Multiple blocks can all have the same block height, as is common when two or more miners each produce a block at roughly the same time. This creates an apparent <a class="reference internal" href="../glossary.html#term-Fork"><span class="xref std std-term">fork</span></a> in the block chain, as shown in the illustration above.</p>
<p>When miners produce simultaneous blocks at the end of the block chain, each node individually chooses which block to accept. In the absence of other considerations, discussed below, nodes usually use the first block they see.</p>
<p>Eventually a miner produces another block which attaches to only one of the competing simultaneously-mined blocks. This makes that side of the fork stronger than the other side. Assuming a fork only contains valid blocks, normal peers always follow the most difficult chain to recreate and throw away <a class="reference internal" href="../glossary.html#term-Stale-block"><span class="xref std std-term">stale blocks</span></a> belonging to shorter forks. (Stale blocks are also sometimes called orphans or orphan blocks, but those terms are also used for true orphan blocks without a known parent block.)</p>
<p>Long-term forks are possible if different miners work at cross-purposes, such as some miners diligently working to extend the block chain at the same time other miners are attempting a 51 percent attack to revise transaction history.</p>
<p>Since multiple blocks can have the same height during a block chain fork, block height should not be used as a globally unique identifier. Instead, blocks are usually referenced by the hash of their header (often with the byte order reversed, and in hexadecimal).</p>
</div>
<div class="section" id="transaction-data">
<h2>Transaction Data<a class="headerlink" href="block_chain.html#transaction-data" title="Permalink to this headline">¶</a></h2>
<p>Every block must include one or more transactions. The first one of these transactions must be a coinbase transaction, also called a generation transaction, which should collect and spend the block reward (comprised of a block subsidy and any transaction fees paid by transactions included in this block).</p>
<p>The UTXO of a coinbase transaction has the special condition that it cannot be spent (used as an input) for at least 100 blocks. This temporarily prevents a miner from spending the transaction fees and block reward from a block that may later be determined to be stale (and therefore the coinbase transaction destroyed) after a block chain fork.</p>
<p>Blocks are not required to include any non-coinbase transactions, but miners almost always do include additional transactions in order to collect their transaction fees.</p>
<p>All transactions, including the coinbase transaction, are encoded into blocks in binary raw transaction format.</p>
<p>The raw transaction format is hashed to create the transaction identifier (txid). From these txids, the <a class="reference internal" href="../glossary.html#term-Merkle-tree"><span class="xref std std-term">merkle tree</span></a> is constructed by pairing each txid with one other txid and then hashing them together. If there are an odd number of txids, the txid without a partner is hashed with a copy of itself.</p>
<p>The resulting hashes themselves are each paired with one other hash and hashed together. Any hash without a partner is hashed with itself. The process repeats until only one hash remains, the merkle root.</p>
<p>For example, if transactions were merely joined (not hashed), a five-transaction merkle tree would look like the following text diagram:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       <span class="n">ABCDEEEE</span> <span class="o">.......</span><span class="n">Merkle</span> <span class="n">root</span>
      <span class="o">/</span>        \
   <span class="n">ABCD</span>        <span class="n">EEEE</span>
  <span class="o">/</span>    \      <span class="o">/</span>
 <span class="n">AB</span>    <span class="n">CD</span>    <span class="n">EE</span> <span class="o">.......</span><span class="n">E</span> <span class="ow">is</span> <span class="n">paired</span> <span class="k">with</span> <span class="n">itself</span>
<span class="o">/</span>  \  <span class="o">/</span>  \  <span class="o">/</span>
<span class="n">A</span>  <span class="n">B</span>  <span class="n">C</span>  <span class="n">D</span>  <span class="n">E</span> <span class="o">.........</span><span class="n">Transactions</span>
</pre></div>
</div>
<p>As discussed in the Simplified Payment Verification (SPV) subsection, the merkle tree allows clients to verify for themselves that a transaction was included in a block by obtaining the merkle root from a block header and a list of the intermediate hashes from a full peer. The full peer does not need to be trusted: it is expensive to fake block headers and the intermediate hashes cannot be faked or the verification will fail.</p>
<p>For example, to verify transaction D was added to the block, an SPV client only needs a copy of the C, AB, and EEEE hashes in addition to the merkle root; the client doesn’t need to know anything about any of the other transactions. If the five transactions in this block were all at the maximum size, downloading the entire block would require over 500,000 bytes—but downloading three hashes plus the block header requires only 140 bytes.</p>
<p>Note: If identical txids are found within the same block, there is a possibility that the merkle tree may collide with a block with some or all duplicates removed due to how unbalanced merkle trees are implemented (duplicating the lone hash). Since it is impractical to have separate transactions with identical txids, this does not impose a burden on honest software, but must be checked if the invalid status of a block is to be cached; otherwise, a valid block with the duplicates eliminated could have the same merkle root and block hash, but be rejected by the cached invalid outcome, resulting in security bugs such as <a class="reference external" href="https://en.pandora.it/wiki/CVEs#CVE-2012-2459">CVE-2012-2459</a>.</p>
</div>
<div class="section" id="consensus-rule-changes">
<h2>Consensus Rule Changes<a class="headerlink" href="block_chain.html#consensus-rule-changes" title="Permalink to this headline">¶</a></h2>
<p>To maintain consensus, all full nodes validate blocks using the same consensus rules. However, sometimes the consensus rules are changed to introduce new features or prevent <a class="reference external" href="p2p_network.html">network</a> abuse. When the new rules are implemented, there will likely be a period of time when non-upgraded nodes follow the old rules and upgraded nodes follow the new rules, creating two possible ways consensus can break:</p>
<ol class="arabic simple">
<li><p>A block following the new consensus rules is accepted by upgraded nodes but rejected by non-upgraded nodes. For example, a new transaction feature is used within a block: upgraded nodes understand the feature and accept it, but non-upgraded nodes reject it because it violates the old rules.</p></li>
<li><p>A block violating the new consensus rules is rejected by upgraded nodes but accepted by non-upgraded nodes. For example, an abusive transaction feature is used within a block: upgraded nodes reject it because it violates the new rules, but non-upgraded nodes accept it because it follows the old rules.</p></li>
</ol>
<p>In the first case, rejection by non-upgraded nodes, mining software which gets block chain data from those non-upgraded nodes refuses to build on the same chain as mining software getting data from upgraded nodes. This creates permanently divergent chains—one for non-upgraded nodes and one for upgraded nodes—called a <a class="reference internal" href="../glossary.html#term-Hard-fork"><span class="xref std std-term">hard fork</span></a>.</p>
<div class="figure align-default" id="id4">
<img alt="Hard Fork" src="../images/en-hard-fork.svg" /><p class="caption"><span class="caption-text">Hard Fork</span><a class="headerlink" href="block_chain.html#id4" title="Permalink to this image">¶</a></p>
</div>
<p>In the second case, rejection by upgraded nodes, it’s possible to keep the block chain from permanently diverging if upgraded nodes control a majority of the hash rate. That’s because, in this case, non-upgraded nodes will accept as valid all the same blocks as upgraded nodes, so the upgraded nodes can build a stronger chain that the non-upgraded nodes will accept as the best valid block chain. This is called a <a class="reference internal" href="../glossary.html#term-Soft-fork"><span class="xref std std-term">soft fork</span></a>.</p>
<div class="figure align-default" id="id5">
<img alt="Soft Fork" src="../images/en-soft-fork.svg" /><p class="caption"><span class="caption-text">Soft Fork</span><a class="headerlink" href="block_chain.html#id5" title="Permalink to this image">¶</a></p>
</div>
<p>Although a fork is an actual divergence in block chains, changes to the consensus rules are often described by their potential to create either a hard or soft fork. For example, “increasing the block size above 1 MB requires a hard fork.” In this example, an actual block chain fork is not required—but it is a possible outcome.</p>
<p>Consensus rule changes may be activated in various ways. During Pandora’s first two years, Satoshi Nakamoto performed several soft forks by just releasing the backwards-compatible change in a client that began immediately enforcing the new rule. Multiple soft forks such as <a class="reference external" href="https://github.com/pdccoin/bips/blob/master/bip-0030.mediawiki">BIP30</a> have been activated via a flag day where the new rule began to be enforced at a preset time or block height. Such forks activated via a flag day are known as <a class="reference internal" href="../glossary.html#term-UASF"><span class="xref std std-term">User Activated Soft Forks</span></a> (UASF) as they are dependent on having sufficient users (nodes) to enforce the new rules after the flag day.</p>
<p>Later soft forks waited for a majority of hash rate (typically 75% or 95%) to signal their readiness for enforcing the new consensus rules. Once the signalling threshold has been passed, all nodes will begin enforcing the new rules. Such forks are known as <a class="reference internal" href="../glossary.html#term-MASF"><span class="xref std std-term">Miner Activated Soft Forks</span></a> (MASF) as they are dependent on miners for activation.</p>
<p><strong>Resources:</strong> <a class="reference external" href="https://github.com/pdccoin/bips/blob/master/bip-0016.mediawiki">BIP16</a>, <a class="reference external" href="https://github.com/pdccoin/bips/blob/master/bip-0030.mediawiki">BIP30</a>, and <a class="reference external" href="https://github.com/pdccoin/bips/blob/master/bip-0034.mediawiki">BIP34</a> were implemented as changes which might have lead to soft forks. <a class="reference external" href="https://github.com/pdccoin/bips/blob/master/bip-0050.mediawiki">BIP50</a> describes both an accidental hard fork, resolved by temporary downgrading the capabilities of upgraded nodes, and an intentional hard fork when the temporary downgrade was removed. A document from Gavin Andresen outlines <a class="reference external" href="https://gist.github.com/gavinandresen/2355445">how future rule changes may be implemented</a>.</p>
</div>
<div class="section" id="detecting-forks">
<h2>Detecting Forks<a class="headerlink" href="block_chain.html#detecting-forks" title="Permalink to this headline">¶</a></h2>
<p>Non-upgraded nodes may use and distribute incorrect information during both types of forks, creating several situations which could lead to financial loss. In particular, non-upgraded nodes may relay and accept transactions that are considered invalid by upgraded nodes and so will never become part of the universally-recognized best block chain. Non-upgraded nodes may also refuse to relay blocks or transactions which have already been added to the best block chain, or soon will be, and so provide incomplete information.</p>
<p>Pandora Core includes code that detects a hard fork by looking at block chain proof of work. If a non-upgraded node receives block chain headers demonstrating at least six blocks more proof of work than the best chain it considers valid, the node reports a warning in the <a class="reference external" href="../reference/rpc/getnetworkinfo.html">“getnetworkinfo” RPC</a> results and runs the <code class="docutils literal notranslate"><span class="pre">-alertnotify</span></code> command if set. This warns the operator that the non-upgraded node can’t switch to what is likely the best block chain.</p>
<p>Full nodes can also check block and transaction version numbers. If the block or transaction version numbers seen in several recent blocks are higher than the version numbers the node uses, it can assume it doesn’t use the current consensus rules. Pandora Core reports this situation through the <a class="reference external" href="../reference/rpc/getnetworkinfo.html">“getnetworkinfo” RPC</a> and <code class="docutils literal notranslate"><span class="pre">-alertnotify</span></code> command if set.</p>
<p>In either case, block and transaction data should not be relied upon if it comes from a node that apparently isn’t using the current consensus rules.</p>
<p>SPV clients which connect to full nodes can detect a likely hard fork by connecting to several full nodes and ensuring that they’re all on the same chain with the same block height, plus or minus several blocks to account for transmission delays and stale blocks. If there’s a divergence, the client can disconnect from nodes with weaker chains.</p>
<p>SPV clients should also monitor for block and <a class="reference internal" href="../terms.html#term-transaction-version-number"><span class="std std-ref">transaction version number</span></a> increases to ensure they process received transactions and create new transactions using the current consensus rules.</p>
</div>
</div>


            </div>
          </div>
        </div>
      </div>
        <div class="clearer"></div>
        </div>
      </div>
    </div>
<footer class="footer">
  <div class="footer-with-logo">
    <div class="footer-container">
      <a href="https://pdccoin.github.io/">
        <div class="footer-logo"></div>
      </a>

      <div class="footer-row ">
        <div class="donate">
          <div class="donate-row">
            <div>
              <span class="footer-title">Support Pandora.org:</span>
              <button onclick="openDonationModal()" class="donate-btn">Donate</button>
              <p class="donate-text">
                <a class="donate-link" href="pandora:3E8ociqZa9mZUSwGdSmAEMAoAxBK3FNDcd" target="_blank">3E8ociqZa9mZUSwGdSmAEMAoAxBK3FNDcd</a>
              </p>
            </div>
          </div>
        </div>
        
        <div class="footermenu">
          <div class="footermenu-item footermenu-introduction">
            <p class="footer-title">Introduction:</p>
            <ul class="footermenu-list">
              <li>
                <a href="https://pdccoin.github.io/pandora-for-individuals">Individuals</a>
              </li>
              <li>
                <a href="https://pdccoin.github.io/pandora-for-businesses">Businesses</a>
              </li>
              <li>
                <a href="../index.html">Developers</a>
              </li>
              <li>
                <a href="https://pdccoin.github.io/getting-started">Getting started</a>
              </li>
              <li>
                <a href="https://pdccoin.github.io/how-it-works">How it works</a>
              </li>
              <li>
                <a href="https://pdccoin.github.io/you-need-to-know">You need to know</a>
              </li>
                <a href="https://pdccoin.github.io/pandora-paper">White paper</a>
              </li>
            </ul>
          </div>
          
          <div class="footermenu-item footermenu-resources">
            <p class="footer-title">Resources:</p>
            <ul class="footermenu-list">
              <li>
                <a href="https://pdccoin.github.io/resources">Resources</a>
              <li>
                <a href="https://pdccoin.github.io/exchanges">Exchanges</a>
              </li>
              <li>
                <a href="https://pdccoin.github.io/community">Community</a>
              </li>
              <li>
                <a href="https://pdccoin.github.io/vocabulary">Vocabulary</a>
              </li>
              <li>
                <a href="https://pdccoin.github.io/events">Events</a>
              </li>
              <li>
                <a href="https://pdccoin.github.io/pandora-core/">Pandora Core</a>
              </li>
            </ul>
          </div>
          
          <div class="footermenu-item footermenu-participate">
            <p class="footer-title">Participate:</p>
            <ul class="footermenu-list">
              <li>
                <a href="https://pdccoin.github.io/support-pandora">Support Pandora</a>
              
              </li>
              <li>
                <a href="https://pdccoin.github.io/buy">Buy Pandora</a>
              </li>
              <li>
                <a href="https://pdccoin.github.io/full-node">Running a full node</a>
              </li>
              <li>
                <a href="https://pdccoin.github.io/development">Development</a>
              </li>
            </ul>
          </div>
          <div class="footermenu-item footermenu-other">
            <p class="footer-title">Other:</p>
            <a href="https://pdccoin.github.io/scams">Avoid Scams</a>
            <a href="https://pdccoin.github.io/legal">Legal</a>
            <a href="https://pdccoin.github.io/privacy">Privacy Policy</a>
            <a href="https://pdccoin.github.io/press">Press</a>
            <a href="https://pdccoin.github.io/about-us">About pandora.org</a>
            <a href="https://pdccoin.github.io/blog">Blog</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="copyright">
      <div>&copy; Copyright Pandora Project 2009-2020.</div>
  </div>
</footer>

<div id="donation-modal" style="display: none" class="donation-modal open">
  <div>
    <div>
      <div class="modal-close-btn" onclick="closeDonationModal()">×</div>
      <p class="modal-header-text">Donate to Pandora.org</p>
    </div>
    <p class="modal-subheader">Use this QR code or address below</p>
    <div style="text-align: center;">
      <div id="donation-qr-code" data-address="3E8ociqZa9mZUSwGdSmAEMAoAxBK3FNDcd"></div>
    </div>
    <div>
      <a
        class="donation-btc-address"
        href="pandora:3E8ociqZa9mZUSwGdSmAEMAoAxBK3FNDcd"
        target="_blank"
      >
        3E8ociqZa9mZUSwGdSmAEMAoAxBK3FNDcd
      </a>
    </div>
    <div style="overflow-y:hidden;text-align: center;">
      <div class="donation-buttons">
        <button type="button" class="donation-amount-btn" data-amount-usd="5">
          $5.00
          <div class="donation-amount-usd-in-btc">(... PDC)</div>
        </button>
        <button type="button" class="donation-amount-btn" data-amount-usd="25">
          $25.00
          <div class="donation-amount-usd-in-btc">(... PDC)</div>
        </button>
        <button type="button" class="donation-amount-btn" data-amount-usd="50">
          $50.00
          <div class="donation-amount-usd-in-btc">(... PDC)</div>
        </button>
      </div>

      <div class="donation-inputs">
        <input
          type="text"
          placeholder="Or custom amount? (PDC)"
          id="donation-input-amount-btc" class="donation-amount-input">
        <input
          type="text"
          placeholder="Or custom amount? (USD)"
          id="donation-input-amount-usd" class="donation-amount-input">
      </div>

      <div>
        <textarea
          class="donation-amount-input"
          id="donation-input-message"
          placeholder="Optional description (for your wallet)"></textarea>
      </div>
    </div>
  </div>
</div>
  </body>
</html>