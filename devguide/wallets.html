
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="description" content="This site aims to provide the docs
                you need to understand Pandora and start building Pandora-based
                applications." />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta property="og:title" content="Wallets &#8212; Pandora" />
    <meta property="og:description" content="This site aims to provide the
    docs you need to understand Pandora and start building Pandora-based
    applications." />
    <meta property="og:image" content="https://developer.pandora.org/static/pandoradocs.png" />
    <meta property="og:type" content="website" />
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:400,700&display=swap" rel="stylesheet">
    
    <title>Wallets &#8212; Pandora</title>

    <link rel="stylesheet" href="../static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/sphinxbootstrap4.css" type="text/css" />
    <link rel="stylesheet" href="../static/bootstrap-4.3.1-dist/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../static/css/main.css" />
    
    <script id="documentation_options" data-url_root="../" src="../static/documentation_options.js"></script>
    <script src="../static/jquery.js"></script>
    <script src="../static/underscore.js"></script>
    <script src="../static/doctools.js"></script>
    <script src="../static/language_data.js"></script>
    <script src="../static/js/jquery.qrcode.js"></script>
    <script type="text/javascript" src="../static/bootstrap-4.3.1-dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../static/sphinxbootstrap4.js"></script>
    <link rel="shortcut icon" href="../static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Payment Processing" href="payment_processing.html" />
    <link rel="prev" title="Contracts" href="contracts.html" /> 
  </head><body>
  
<nav class="navbar navbar-expand-md  fixed-top navbar-dark">
		<div class="content-container d-flex flex-wrap">
			<a class="navbar-brand py-1" href="../index.html">
				<div class="header-logo">
					<div class="logo-light"></div>
				</div>
			</a>
			<button class="navbar-toggler navbar-dark ml-auto py-2 black" type="button" data-toggle="collapse"
				data-target="#exCollapsingNavbar2">
				&#9776;
			</button>
			<div class="navbar-collapse collapse" id="exCollapsingNavbar2">
				<ul class="navbar-nav mr-auto">
					
				</ul>
				<div class="dropdown-divider d-block d-md-none my-3"></div>
				
<form class="form-inline navbar-search" action="../search.html" method="get">
  <input type="text" name="q" class="navbar-search-input form-control" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>

			</div>
		</div>
	
		<!--<div class="row hidden-sm-up">
						<div class="collapse navbar-toggleable-xs container" id="exCollapsingNavbar2">
								<div class="container">
								　　 <a class="navbar-brand" href="../index.html">
												Pandora
										</a>
								</div>
								<ul class="nav navbar-nav">
								</ul>
								<div class="dropdown-divider"></div>
								<div class="navbar-text">search<div>
								
<form class="form-inline navbar-search" action="../search.html" method="get">
  <input type="text" name="q" class="navbar-search-input form-control" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>

						</div>
				</div>-->
</nav>
</div>

  
  <div class="breadcrumbs-section" role="navigation" aria-label="related navigation">
	<div class="content-container">
		<div class="d-flex justify-content-between flex-wrap">
			<ol class="breadcrumb">
				<li class="breadcrumb-item">
					<a href="../index.html">Pandora</a>
				</li>
				<li class="breadcrumb-item">
					<a href="index.html"  accesskey="U" class="active" >Developer Guides</a>
				</li>
				<li class="breadcrumb-item active">Wallets</li>
			</ol>

			<div class="btn-group btn-group-sm" role="group" aria-label="Basic example">
				<a href="contracts.html" title="Previous Chapter: Contracts" class="btn btn-primary"
					role="botton" accesskey="P">
					&laquo; Contracts
				</a>
				<a href="payment_processing.html" title="Next Chapter: Payment Processing" class="btn btn-primary"
					role="botton" accesskey="N">
					Payment Processing &raquo;
				</a>
			</div>
		</div>
	</div>
</div>

  <div class="main container-fluid">
    <div class="content-container">
      <div class="row"> 
  
      <div class="sphinxsidebar d-none d-md-block">
        <div class="sphinxsidebarwrapper">          
            <h4>Table Of Contents</h4>
            
            
              <div class="sidebartoctree">
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="block_chain.html">Block Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="transactions.html">Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="contracts.html">Contracts</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="wallets.html#">Wallets</a></li>
<li class="toctree-l2"><a class="reference internal" href="payment_processing.html">Payment Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="operating_modes.html">Operating Modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="p2p_network.html">P2P Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="mining.html">Mining</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/block_chain.html">Block Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/transactions.html">Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/wallets.html">Wallets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/p2p_networking.html">P2P Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/rpc/index.html">RPC API Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/testing.html">Testing Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/transactions.html">Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/payment_processing.html">Payment Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/p2p_networking.html">P2P Network</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

              </div>
            
          
  <h4>Previous topic</h4>
  <p class="topless"><a href="contracts.html"
                        title="previous chapter">Contracts</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="payment_processing.html"
                        title="next chapter">Payment Processing</a></p>
















  <div>
    <h4>Contribute</h4>
    <p class="topless">
      <a href="https://github.com/pandora-documentation/website/blob/master/devguide/wallets.rst">Edit Page</a>
    </p>
  </div>
        </div>
      </div>
       
  
        <div class="document">
        <div class="documentwrapper">
          <div class="bodywrapper">
            <div class="body">
              
  <div class="section" id="wallets">
<h1>Wallets<a class="headerlink" href="wallets.html#wallets" title="Permalink to this headline">¶</a></h1>
<p>A Pandora wallet can refer to either a wallet program or a wallet file.</p>
<div class="section" id="introductions">
<h2>Introductions<a class="headerlink" href="wallets.html#introductions" title="Permalink to this headline">¶</a></h2>
<p>Wallet programs create public keys to receive satoshis and use the corresponding private keys to spend those satoshis. Wallet files store private keys and (optionally) other information related to transactions for the wallet program.</p>
<p>Wallet programs and wallet files are addressed below in separate subsections, and this document attempts to always make it clear whether we’re talking about wallet programs or wallet files.</p>
</div>
<div class="section" id="wallet-programs">
<h2>Wallet Programs<a class="headerlink" href="wallets.html#wallet-programs" title="Permalink to this headline">¶</a></h2>
<p>Permitting receiving and spending of satoshis is the only essential feature of wallet software—but a particular wallet program doesn’t need to do both things. Two wallet programs can work together, one program distributing public keys in order to receive satoshis and another program signing transactions spending those satoshis.</p>
<p>Wallet programs also need to interact with the <a class="reference external" href="p2p_network.html">peer-to-peer network</a> to get information from the block chain and to broadcast new transactions. However, the programs which distribute public keys or sign transactions don’t need to interact with the <a class="reference external" href="p2p_network.html">peer-to-peer network</a> themselves.</p>
<p>This leaves us with three necessary, but separable, parts of a wallet system: a public key distribution program, a signing program, and a networked program. In the subsections below, we will describe common combinations of these parts.</p>
<p>Note: we speak about distributing public keys generically. In many cases, P2PKH or P2SH hashes will be distributed instead of public keys, with the actual public keys only being distributed when the outputs they control are spent.</p>
<div class="section" id="full-service-wallets">
<h3>Full-Service Wallets<a class="headerlink" href="wallets.html#full-service-wallets" title="Permalink to this headline">¶</a></h3>
<p>The simplest wallet is a program which performs all three functions: it generates private keys, derives the corresponding public keys, helps distribute those public keys as necessary, monitors for outputs spent to those public keys, creates and signs transactions spending those outputs, and broadcasts the signed transactions.</p>
<div class="figure align-default" id="id1">
<img alt="Full-Service Wallets" src="../images/en-wallets-full-service.svg" /><p class="caption"><span class="caption-text">Full-Service Wallets</span><a class="headerlink" href="wallets.html#id1" title="Permalink to this image">¶</a></p>
</div>
<p>As of this writing, almost all popular wallets can be used as full-service wallets.</p>
<p>The main advantage of full-service wallets is that they are easy to use. A single program does everything the user needs to receive and spend satoshis.</p>
<p>The main disadvantage of full-service wallets is that they store the private keys on a device connected to the Internet. The compromise of such devices is a common occurrence, and an Internet connection makes it easy to transmit private keys from a compromised device to an attacker.</p>
<p>To help protect against theft, many wallet programs offer users the option of encrypting the wallet files which contain the private keys. This protects the private keys when they aren’t being used, but it cannot protect against an attack designed to capture the encryption key or to read the decrypted keys from memory.</p>
</div>
<div class="section" id="signing-only-wallets">
<h3>Signing-Only Wallets<a class="headerlink" href="wallets.html#signing-only-wallets" title="Permalink to this headline">¶</a></h3>
<p>To increase security, private keys can be generated and stored by a separate wallet program operating in a more secure environment. These signing-only wallets work in conjunction with a networked wallet which interacts with the <a class="reference external" href="p2p_network.html">peer-to-peer network</a>.</p>
<p>Signing-only wallets programs typically use deterministic key creation (described in a later subsection) to create parent private and public keys which can create child private and public keys.</p>
<div class="figure align-default" id="id2">
<img alt="Signing-Only Wallets" src="../images/en-wallets-signing-only.svg" /><p class="caption"><span class="caption-text">Signing-Only Wallets</span><a class="headerlink" href="wallets.html#id2" title="Permalink to this image">¶</a></p>
</div>
<p>When first run, the signing-only wallet creates a parent private key and transfers the corresponding parent public key to the networked wallet.</p>
<p>The networked wallet uses the parent public key to derive child public keys, optionally helps distribute them, monitors for outputs spent to those public keys, creates unsigned transactions spending those outputs, and transfers the unsigned transactions to the signing-only wallet.</p>
<p>Often, users are given a chance to review the unsigned transactions’ details (particularly the output details) using the signing-only wallet.</p>
<p>After the optional review step, the signing-only wallet uses the parent private key to derive the appropriate child private keys and signs the transactions, giving the signed transactions back to the networked wallet.</p>
<p>The networked wallet then broadcasts the signed transactions to the <a class="reference external" href="p2p_network.html">peer-to-peer network</a>.</p>
<p>The following subsections describe the two most common variants of signing-only wallets: offline wallets and hardware wallets.</p>
<div class="section" id="offline-wallets">
<h4>Offline Wallets<a class="headerlink" href="wallets.html#offline-wallets" title="Permalink to this headline">¶</a></h4>
<p>Several full-service wallets programs will also operate as two separate wallets: one program instance acting as a signing-only wallet (often called an “offline wallet”) and the other program instance acting as the networked wallet (often called an “online wallet” or “watching-only wallet”).</p>
<p>The offline wallet is so named because it is intended to be run on a device which does not connect to any <a class="reference external" href="p2p_network.html">network</a>, greatly reducing the number of attack vectors. If this is the case, it is usually up to the user to handle all data transfer using removable media such as USB drives. The user’s workflow is something like:</p>
<ol class="arabic simple">
<li><p>(Offline) Disable all <a class="reference external" href="p2p_network.html">network</a> connections on a device and install the wallet software. Start the wallet software in offline mode to create the parent private and public keys. Copy the parent public key to removable media.</p></li>
<li><p>(Online) Install the wallet software on another device, this one connected to the Internet, and import the parent public key from the removable media. As you would with a full-service wallet, distribute public keys to receive payment. When ready to spend satoshis, fill in the output details and save the unsigned transaction generated by the wallet to removable media.</p></li>
<li><p>(Offline) Open the unsigned transaction in the offline instance, review the output details to make sure they spend the correct amount to the correct address. This prevents malware on the online wallet from tricking the user into signing a transaction which pays an attacker. After review, sign the transaction and save it to removable media.</p></li>
<li><p>(Online) Open the signed transaction in the online instance so it can broadcast it to the <a class="reference external" href="p2p_network.html">peer-to-peer network</a>.</p></li>
</ol>
<p>The primary advantage of offline wallets is their possibility for greatly improved security over full-service wallets. As long as the offline wallet is not compromised (or flawed) and the user reviews all outgoing transactions before signing, the user’s satoshis are safe even if the online wallet is compromised.</p>
<p>The primary disadvantage of offline wallets is hassle. For maximum security, they require the user dedicate a device to only offline tasks. The offline device must be booted up whenever funds are to be spent, and the user must physically copy data from the online device to the offline device and back.</p>
</div>
<div class="section" id="hardware-wallets">
<h4>Hardware Wallets<a class="headerlink" href="wallets.html#hardware-wallets" title="Permalink to this headline">¶</a></h4>
<p>Hardware wallets are devices dedicated to running a signing-only wallet. Their dedication lets them eliminate many of the vulnerabilities present in operating systems designed for general use, allowing them to safely communicate directly with other devices so users don’t need to transfer data manually. The user’s workflow is something like:</p>
<ol class="arabic simple">
<li><p>(Hardware) Create parent private and public keys. Connect hardware wallet to a networked device so it can get the parent public key.</p></li>
<li><p>(Networked) As you would with a full-service wallet, distribute public keys to receive payment. When ready to spend satoshis, fill in the transaction details, connect the hardware wallet, and click Spend. The networked wallet will automatically send the transaction details to the hardware wallet.</p></li>
<li><p>(Hardware) Review the transaction details on the hardware wallet’s screen. Some hardware wallets may prompt for a passphrase or PIN number. The hardware wallet signs the transaction and uploads it to the networked wallet.</p></li>
<li><p>(Networked) The networked wallet receives the signed transaction from the hardware wallet and broadcasts it to the <a class="reference external" href="p2p_network.html">network</a>.</p></li>
</ol>
<p>The primary advantage of hardware wallets is their possibility for greatly improved security over full-service wallets with much less hassle than offline wallets.</p>
<p>The primary disadvantage of hardware wallets is their hassle. Even though the hassle is less than that of offline wallets, the user must still purchase a hardware wallet device and carry it with them whenever they need to make a transaction using the signing-only wallet.</p>
<p>An additional (hopefully temporary) disadvantage is that, as of this writing, very few popular wallet programs support hardware wallets—although almost all popular wallet programs have announced their intention to support at least one model of hardware wallet.</p>
</div>
</div>
<div class="section" id="distributing-only-wallets">
<h3>Distributing-Only Wallets<a class="headerlink" href="wallets.html#distributing-only-wallets" title="Permalink to this headline">¶</a></h3>
<p>Wallet programs which run in difficult-to-secure environments, such as webservers, can be designed to distribute public keys (including P2PKH or P2SH addresses) and nothing more. There are two common ways to design these minimalist wallets:</p>
<div class="figure align-default" id="id3">
<img alt="Distributing-Only Wallets" src="../images/en-wallets-distributing-only.svg" /><p class="caption"><span class="caption-text">Distributing-Only Wallets</span><a class="headerlink" href="wallets.html#id3" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>Pre-populate a database with a number of public keys or addresses, and then distribute on request a pubkey script or address using one of the database entries. To <a class="reference external" href="transactions.html#avoiding-key-reuse">avoid key reuse</a>, webservers should keep track of used keys and never run out of public keys. This can be made easier by using parent public keys as suggested in the next method.</p></li>
<li><p>Use a parent public key to create child public keys. To avoid key reuse, a method must be used to ensure the same public key isn’t distributed twice. This can be a database entry for each key distributed or an incrementing pointer to the <a class="reference internal" href="../terms.html#term-key-index"><span class="std std-ref">key index</span></a> number.</p></li>
</ul>
<p>Neither method adds a significant amount of overhead, especially if a database is used anyway to associate each incoming payment with a separate public key for payment tracking. See the <a class="reference external" href="payment_processing.html">Payment Processing</a> section for details.</p>
</div>
</div>
<div class="section" id="wallet-files">
<h2>Wallet Files<a class="headerlink" href="wallets.html#wallet-files" title="Permalink to this headline">¶</a></h2>
<p>Pandora wallets at their core are a collection of private keys. These collections are stored digitally in a file, or can even be physically stored on pieces of paper.</p>
<div class="section" id="private-key-formats">
<h3>Private Key Formats<a class="headerlink" href="wallets.html#private-key-formats" title="Permalink to this headline">¶</a></h3>
<p>Private keys are what are used to unlock satoshis from a particular address. In Pandora, a private key in standard format is simply a 256-bit number, between the values:</p>
<p>0x01 and 0xFFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFE BAAE DCE6 AF48 A03B BFD2 5E8C D036 4140, representing nearly the entire range of 2256-1 values. The range is governed by the <a class="reference external" href="http://www.secg.org/sec2-v2.pdf">secp256k1</a> <a class="reference external" href="https://en.wikipedia.org/wiki/Elliptic_Curve_DSA">ECDSA</a> encryption standard used by Pandora.</p>
<div class="section" id="wallet-import-format-wif">
<h4>Wallet Import Format (WIF)<a class="headerlink" href="wallets.html#wallet-import-format-wif" title="Permalink to this headline">¶</a></h4>
<p>In order to make copying of private keys less prone to error, <a class="reference internal" href="../glossary.html#term-Wallet-Import-Format"><span class="xref std std-term">Wallet Import Format</span></a> may be utilized. WIF uses base58Check encoding on a private key, greatly decreasing the chance of copying error, much like standard Pandora addresses.</p>
<ol class="arabic simple">
<li><p>Take a private key.</p></li>
<li><p>Add a 0x80 byte in front of it for mainnet addresses or 0xef for testnet addresses.</p></li>
<li><p>Append a 0x01 byte after it if it should be used with compressed public keys (described in a later subsection). Nothing is appended if it is used with uncompressed public keys.</p></li>
<li><p>Perform a SHA-256 hash on the extended key.</p></li>
<li><p>Perform a SHA-256 hash on result of SHA-256 hash.</p></li>
<li><p>Take the first four bytes of the second SHA-256 hash; this is the checksum.</p></li>
<li><p>Add the four checksum bytes from point 5 at the end of the extended key from point 2.</p></li>
<li><p>Convert the result from a byte string into a Base58 string using Base58Check encoding.</p></li>
</ol>
<p>The process is easily reversible, using the Base58 decoding function, and removing the padding.</p>
</div>
<div class="section" id="mini-private-key-format">
<h4>Mini Private Key Format<a class="headerlink" href="wallets.html#mini-private-key-format" title="Permalink to this headline">¶</a></h4>
<p>Mini private key format is a method for encoding a private key in under 30 characters, enabling keys to be embedded in a small physical space, such as physical pandora tokens, and more damage-resistant QR codes.</p>
<ol class="arabic simple">
<li><p>The first character of mini keys is ‘S’.</p></li>
<li><p>In order to determine if a mini private key is well-formatted, a question mark is added to the private key.</p></li>
<li><p>The SHA256 hash is calculated. If the first byte produced is a `00’, it is well-formatted. This key restriction acts as a typo-checking mechanism. A user brute forces the process using random numbers until a well-formatted mini private key is produced.</p></li>
<li><p>In order to derive the full private key, the user simply takes a single SHA256 hash of the original mini private key. This process is one-way: it is intractable to compute the mini private key format from the derived key.</p></li>
</ol>
<p>Many implementations disallow the character ‘1’ in the mini private key due to its visual similarity to ‘l’.</p>
<p><strong>Resource:</strong> A common tool to create and redeem these keys is the <a class="reference external" href="https://github.com/casascius/Pandora-Address-Utility">Casascius Pandora Address Utility</a>.</p>
</div>
</div>
<div class="section" id="public-key-formats">
<h3>Public Key Formats<a class="headerlink" href="wallets.html#public-key-formats" title="Permalink to this headline">¶</a></h3>
<p>Pandora <a class="reference external" href="https://en.wikipedia.org/wiki/Elliptic_Curve_DSA">ECDSA</a> public keys represent a point on a particular Elliptic Curve (EC) defined in <a class="reference external" href="http://www.secg.org/sec2-v2.pdf">secp256k1</a>. In their traditional uncompressed form, public keys contain an identification byte, a 32-byte X coordinate, and a 32-byte Y coordinate. The extremely simplified illustration below shows such a point on the elliptic curve used by Pandora, y2 = x3 + 7, over a field of contiguous numbers.</p>
<div class="figure align-default" id="id4">
<img alt="Point On ECDSA Curve" src="../images/en-ecdsa-compressed-public-key.svg" /><p class="caption"><span class="caption-text">Point On ECDSA Curve</span><a class="headerlink" href="wallets.html#id4" title="Permalink to this image">¶</a></p>
</div>
<p>(<a class="reference external" href="http://www.secg.org/sec2-v2.pdf">Secp256k1</a> actually modulos coordinates by a large prime, which produces a field of non-contiguous integers and a significantly less clear plot, although the principles are the same.)</p>
<p>An almost 50% reduction in public key size can be realized without changing any fundamentals by dropping the Y coordinate. This is possible because only two points along the curve share any particular X coordinate, so the 32-byte Y coordinate can be replaced with a single bit indicating whether the point is on what appears in the illustration as the “top” side or the “bottom” side.</p>
<p>No data is lost by creating these compressed public keys—only a small amount of CPU is necessary to reconstruct the Y coordinate and access the uncompressed public key. Both uncompressed and compressed public keys are described in official <a class="reference external" href="http://www.secg.org/sec2-v2.pdf">secp256k1</a> documentation and supported by default in the widely-used OpenSSL library.</p>
<p>Because they’re easy to use, and because they reduce almost by half the block chain space used to store public keys for every spent output, compressed public keys are the default in Pandora Core and are the recommended default for all Pandora software.</p>
<p>However, Pandora Core prior to 0.6 used uncompressed keys. This creates a few complications, as the hashed form of an uncompressed key is different than the hashed form of a compressed key, so the same key works with two different P2PKH addresses. This also means that the key must be submitted in the correct format in the signature script so it matches the hash in the previous output’s pubkey script.</p>
<p>For this reason, Pandora Core uses several different identifier bytes to help programs identify how keys should be used:</p>
<ul class="simple">
<li><p>Private keys meant to be used with compressed public keys have 0x01 appended to them before being Base-58 encoded. (See the private key encoding section above.)</p></li>
<li><p>Uncompressed public keys start with 0x04; compressed public keys begin with 0x03 or 0x02 depending on whether they’re greater or less than the midpoint of the curve. These prefix bytes are all used in official <a class="reference external" href="http://www.secg.org/sec2-v2.pdf">secp256k1</a> documentation.</p></li>
</ul>
</div>
<div class="section" id="hierarchical-deterministic-key-creation">
<h3>Hierarchical Deterministic Key Creation<a class="headerlink" href="wallets.html#hierarchical-deterministic-key-creation" title="Permalink to this headline">¶</a></h3>
<!--
For consistent word ordering:
[normal|hardened|] [master|parent|child|grandchild] [extended|non-extended|] [private|public|chain] [key|code]
--><p>The hierarchical deterministic key creation and transfer protocol (<a class="reference internal" href="../glossary.html#term-HD-protocol"><span class="xref std std-term">HD protocol</span></a>) greatly simplifies wallet backups, eliminates the need for repeated communication between multiple programs using the same wallet, permits creation of child accounts which can operate independently, gives each parent account the ability to monitor or control its children even if the child account is compromised, and divides each account into full-access and restricted-access parts so untrusted users or programs can be allowed to receive or monitor payments without being able to spend them.</p>
<p>The HD protocol takes advantage of the <a class="reference external" href="https://en.wikipedia.org/wiki/Elliptic_Curve_DSA">ECDSA</a> public key creation function, <a class="reference internal" href="../terms.html#term-point-function"><span class="std std-ref">“point()”</span></a>, which takes a large integer (the private key) and turns it into a graph point (the public key):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">point</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span> <span class="o">==</span> <span class="n">public_key</span>
</pre></div>
</div>
<p>Because of the way <a class="reference internal" href="../terms.html#term-point-function"><span class="std std-ref">“point()”</span></a> works, it’s possible to create a <a class="reference internal" href="../glossary.html#term-Child-key"><span class="xref std std-term">child public key</span></a> by combining an existing <a class="reference internal" href="../glossary.html#term-Parent-key"><span class="xref std std-term">(parent) public key</span></a> with another public key created from any integer (<em>i</em>) value. This child public key is the same public key which would be created by the <a class="reference internal" href="../terms.html#term-point-function"><span class="std std-ref">“point()”</span></a> function if you added the <em>i</em> value to the original (parent) private key and then found the remainder of that sum divided by a global constant used by all Pandora software (<em>p</em>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">point</span><span class="p">(</span> <span class="p">(</span><span class="n">parent_private_key</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span> <span class="p">)</span> <span class="o">==</span> <span class="n">parent_public_key</span> <span class="o">+</span> <span class="n">point</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>This means that two or more independent programs which agree on a sequence of integers can create a series of unique <a class="reference internal" href="../glossary.html#term-Child-key"><span class="xref std std-term">child key</span></a> pairs from a single <a class="reference internal" href="../glossary.html#term-Parent-key"><span class="xref std std-term">parent key</span></a> pair without any further communication. Moreover, the program which distributes new public keys for receiving payment can do so without any access to the private keys, allowing the public key distribution program to run on a possibly-insecure platform such as a public web server.</p>
<p>Child public keys can also create their own child public keys (grandchild public keys) by repeating the child key derivation operations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">point</span><span class="p">(</span> <span class="p">(</span><span class="n">child_private_key</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span> <span class="p">)</span> <span class="o">==</span> <span class="n">child_public_key</span> <span class="o">+</span> <span class="n">point</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>Whether creating child public keys or further-descended public keys, a predictable sequence of integer values would be no better than using a single public key for all transactions, as anyone who knew one child public key could find all of the other child public keys created from the same parent public key. Instead, a random seed can be used to deterministically generate the sequence of integer values so that the relationship between the child public keys is invisible to anyone without that seed.</p>
<p>The HD protocol uses a single root seed to create a hierarchy of child, grandchild, and other descended keys with unlinkable deterministically-generated integer values. Each child key also gets a deterministically-generated seed from its parent, called a <a class="reference internal" href="../glossary.html#term-Chain-code"><span class="xref std std-term">chain code</span></a>, so the compromising of one chain code doesn’t necessarily compromise the integer sequence for the whole hierarchy, allowing the <a class="reference internal" href="../glossary.html#term-Master-chain-code"><span class="xref std std-term">master chain code</span></a> to continue being useful even if, for example, a web-based public key distribution program gets hacked.</p>
<div class="figure align-default" id="id5">
<img alt="Overview Of Hierarchical Deterministic Key Derivation" src="../images/en-hd-overview.svg" /><p class="caption"><span class="caption-text">Overview Of Hierarchical Deterministic Key Derivation</span><a class="headerlink" href="wallets.html#id5" title="Permalink to this image">¶</a></p>
</div>
<p>As illustrated above, HD key derivation takes four inputs:</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="../glossary.html#term-Parent-key"><span class="xref std std-term">parent private key</span></a> and <em>parent public key</em> are regular uncompressed 256-bit <a class="reference external" href="https://en.wikipedia.org/wiki/Elliptic_Curve_DSA">ECDSA</a> keys.</p></li>
<li><p>The <a class="reference internal" href="../glossary.html#term-Chain-code"><span class="xref std std-term">parent chain code</span></a> is 256 bits of seemingly-random data.</p></li>
<li><p>The <a class="reference internal" href="../terms.html#term-key-index"><span class="std std-ref">index</span></a> number is a 32-bit integer specified by the program.</p></li>
</ul>
<p>In the normal form shown in the above illustration, the parent chain code, the parent public key, and the index number are fed into a one-way cryptographic hash (<a class="reference external" href="https://en.wikipedia.org/wiki/HMAC">HMAC-SHA512</a>) to produce 512 bits of deterministically-generated-but-seemingly-random data. The seemingly-random 256 bits on the righthand side of the hash output are used as a new child chain code. The seemingly-random 256 bits on the lefthand side of the hash output are used as the integer value to be combined with either the parent private key or parent public key to, respectively, create either a child private key or child public key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">child_private_key</span> <span class="o">==</span> <span class="p">(</span><span class="n">parent_private_key</span> <span class="o">+</span> <span class="n">lefthand_hash_output</span><span class="p">)</span> <span class="o">%</span> <span class="n">G</span>
<span class="n">child_public_key</span> <span class="o">==</span> <span class="n">point</span><span class="p">(</span> <span class="p">(</span><span class="n">parent_private_key</span> <span class="o">+</span> <span class="n">lefthand_hash_output</span><span class="p">)</span> <span class="o">%</span> <span class="n">G</span> <span class="p">)</span>
<span class="n">child_public_key</span> <span class="o">==</span> <span class="n">point</span><span class="p">(</span><span class="n">child_private_key</span><span class="p">)</span> <span class="o">==</span> <span class="n">parent_public_key</span> <span class="o">+</span> <span class="n">point</span><span class="p">(</span><span class="n">lefthand_hash_output</span><span class="p">)</span>
</pre></div>
</div>
<p>Specifying different index numbers will create different unlinkable child keys from the same parent keys. Repeating the procedure for the child keys using the child chain code will create unlinkable grandchild keys.</p>
<p>Because creating child keys requires both a key and a chain code, the key and chain code together are called the <a class="reference internal" href="../glossary.html#term-Extended-key"><span class="xref std std-term">extended key</span></a>. An <a class="reference internal" href="../glossary.html#term-Extended-key"><span class="xref std std-term">extended private key</span></a> and its corresponding <a class="reference internal" href="../glossary.html#term-Extended-key"><span class="xref std std-term">extended public key</span></a> have the same chain code. The (top-level parent) <a class="reference internal" href="../glossary.html#term-Master-chain-code"><span class="xref std std-term">master private key</span></a> and master chain code are derived from random data, as illustrated below.</p>
<div class="figure align-default" id="id6">
<img alt="Creating A Root Extended Key Pair" src="../images/en-hd-root-keys.svg" /><p class="caption"><span class="caption-text">Creating A Root Extended Key Pair</span><a class="headerlink" href="wallets.html#id6" title="Permalink to this image">¶</a></p>
</div>
<p>A <a class="reference internal" href="../glossary.html#term-HD-wallet-seed"><span class="xref std std-term">root seed</span></a> is created from either 128 bits, 256 bits, or 512 bits of random data. This root seed of as little as 128 bits is the only data the user needs to backup in order to derive every key created by a particular wallet program using particular settings.</p>
<p><img alt="Warning icon" src="../images/icon_warning.svg" /> <strong>Warning:</strong> As of this writing, HD wallet programs are not expected to be fully compatible, so users must only use the same HD wallet program with the same HD-related settings for a particular root seed.</p>
<p>The root seed is hashed to create 512 bits of seemingly-random data, from which the master private key and master chain code are created (together, the master extended private key). The master public key is derived from the master private key using <a class="reference internal" href="../terms.html#term-point-function"><span class="std std-ref">“point()”</span></a>, which, together with the master chain code, is the master extended public key. The master extended keys are functionally equivalent to other extended keys; it is only their location at the top of the hierarchy which makes them special.</p>
<div class="section" id="hardened-keys">
<h4>Hardened Keys<a class="headerlink" href="wallets.html#hardened-keys" title="Permalink to this headline">¶</a></h4>
<p>Hardened extended keys fix a potential problem with normal extended keys. If an attacker gets a normal parent chain code and parent public key, he can brute-force all chain codes deriving from it. If the attacker also obtains a child, grandchild, or further-descended private key, he can use the chain code to generate all of the extended private keys descending from that private key, as shown in the grandchild and great-grandchild generations of the illustration below.</p>
<div class="figure align-default" id="id7">
<img alt="Cross-Generational Key Compromise" src="../images/en-hd-cross-generational-key-compromise.svg" /><p class="caption"><span class="caption-text">Cross-Generational Key Compromise</span><a class="headerlink" href="wallets.html#id7" title="Permalink to this image">¶</a></p>
</div>
<p>Perhaps worse, the attacker can reverse the normal child private key derivation formula and subtract a parent chain code from a child private key to recover the parent private key, as shown in the child and parent generations of the illustration above. This means an attacker who acquires an extended public key and any private key descended from it can recover that public key’s private key and all keys descended from it.</p>
<p>For this reason, the chain code part of an extended public key should be better secured than standard public keys and users should be advised against exporting even non-extended private keys to possibly-untrustworthy environments.</p>
<p>This can be fixed, with some tradeoffs, by replacing the normal key derivation formula with a hardened key derivation formula.</p>
<p>The normal key derivation formula, described in the section above, combines together the index number, the parent chain code, and the parent public key to create the child chain code and the integer value which is combined with the parent private key to create the child private key.</p>
<div class="figure align-default" id="id8">
<img alt="Creating Child Public Keys From An Extended Private Key" src="../images/en-hd-private-parent-to-private-child.svg" /><p class="caption"><span class="caption-text">Creating Child Public Keys From An Extended Private Key</span><a class="headerlink" href="wallets.html#id8" title="Permalink to this image">¶</a></p>
</div>
<p>The hardened formula, illustrated above, combines together the index number, the parent chain code, and the parent private key to create the data used to generate the child chain code and child private key. This formula makes it impossible to create child public keys without knowing the parent private key. In other words, parent extended public keys can’t create hardened child public keys.</p>
<p>Because of that, a <a class="reference internal" href="../glossary.html#term-Hardened-extended-key"><span class="xref std std-term">hardened extended private key</span></a> is much less useful than a normal extended private key—however, hardened extended private keys create a firewall through which multi-level key derivation compromises cannot happen. Because hardened child extended public keys cannot generate grandchild chain codes on their own, the compromise of a parent extended public key cannot be combined with the compromise of a grandchild private key to create great-grandchild extended private keys.</p>
<p>The HD protocol uses different index numbers to indicate whether a normal or hardened key should be generated. Index numbers from 0x00 to 0x7fffffff (0 to 231-1) will generate a normal key; index numbers from 0x80000000 to 0xffffffff will generate a hardened key. To make descriptions easy, many developers use the <a class="reference external" href="https://en.wikipedia.org/wiki/Prime_%28symbol%29">prime symbol</a> to indicate hardened keys, so the first normal key (0x00) is 0 and the first hardened key (0x80000000) is 0´.</p>
<p>(Pandora developers typically use the ASCII apostrophe rather than the unicode prime symbol, a convention we will henceforth follow.)</p>
<p>This compact description is further combined with slashes prefixed by <em>m</em> or <em>M</em> to indicate hierarchy and key type, with <em>m</em> being a private key and <em>M</em> being a public key. For example, m/0’/0/122’ refers to the 123rd hardened private child (by index number) of the first normal child (by index) of the first hardened child (by index) of the master private key. The following hierarchy illustrates prime notation and hardened key firewalls.</p>
<div class="figure align-default" id="id9">
<img alt="Example HD Wallet Tree Using Prime Notation" src="../images/en-hd-tree.svg" /><p class="caption"><span class="caption-text">Example HD Wallet Tree Using Prime Notation</span><a class="headerlink" href="wallets.html#id9" title="Permalink to this image">¶</a></p>
</div>
<p>Wallets following the <a class="reference external" href="https://github.com/pandora/bips/blob/master/bip-0032.mediawiki">BIP32</a> HD protocol only create hardened children of the master private key (<em>m</em>) to prevent a compromised child key from compromising the master key. As there are no normal children for the master keys, the master public key is not used in HD wallets. All other keys can have normal children, so the corresponding extended public keys may be used instead.</p>
<p>The HD protocol also describes a serialization format for extended public keys and extended private keys. For details, please see the <a class="reference external" href="../reference/wallets.html">wallet section in the developer reference</a> or <a class="reference external" href="https://github.com/pandora/bips/blob/master/bip-0032.mediawiki">BIP32</a> for the full HD protocol specification.</p>
</div>
<div class="section" id="storing-root-seeds">
<h4>Storing Root Seeds<a class="headerlink" href="wallets.html#storing-root-seeds" title="Permalink to this headline">¶</a></h4>
<p>Root seeds in the HD protocol are 128, 256, or 512 bits of random data which must be backed up precisely. To make it more convenient to use non-digital backup methods, such as memorization or hand-copying, <a class="reference external" href="https://github.com/pandora/bips/blob/master/bip-0039.mediawiki">BIP39</a> defines a method for creating a 512-bit root seed from a pseudo-sentence (mnemonic) of common natural-language words which was itself created from 128 to 256 bits of entropy and optionally protected by a password.</p>
<p>The number of words generated correlates to the amount of entropy used:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Entropy Bits</p></th>
<th class="head"><p>Words</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>128</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>160</p></td>
<td><p>15</p></td>
</tr>
<tr class="row-even"><td><p>192</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>224</p></td>
<td><p>21</p></td>
</tr>
<tr class="row-even"><td><p>256</p></td>
<td><p>24</p></td>
</tr>
</tbody>
</table>
<p>The passphrase can be of any length. It is simply appended to the mnemonic pseudo-sentence, and then both the mnemonic and password are hashed 2,048 times using HMAC-SHA512, resulting in a seemingly-random 512-bit seed. Because any input to the hash function creates a seemingly-random 512-bit seed, there is no fundamental way to prove the user entered the correct password, possibly allowing the user to protect a seed even when under duress.</p>
<p>For implementation details, please see <a class="reference external" href="https://github.com/pandora/bips/blob/master/bip-0039.mediawiki">BIP39</a>.</p>
</div>
</div>
<div class="section" id="loose-key-wallets">
<h3>Loose-Key Wallets<a class="headerlink" href="wallets.html#loose-key-wallets" title="Permalink to this headline">¶</a></h3>
<p>Loose-Key wallets, also called “Just a Bunch Of Keys (JBOK)”, are a deprecated form of wallet that originated from the Pandora Core client wallet. The Pandora Core client wallet would create 100 private key/public key pairs automatically via a Pseudo-Random-Number Generator (PRNG) for later use.</p>
<p>These unused private keys are stored in a virtual “key pool”, with new keys being generated whenever a previously-generated key was used, ensuring the pool maintained 100 unused keys. (If the wallet is encrypted, new keys are only generated while the wallet is unlocked.)</p>
<p>This created considerable difficulty in backing up one’s keys, considering backups have to be run manually to save the newly-generated private keys. If a new <a class="reference internal" href="../terms.html#term-key-pair"><span class="std std-ref">key pair</span></a> set is generated, used, and then lost prior to a backup, the stored satoshis are likely lost forever. Many older-style mobile wallets followed a similar format, but only generated a new private key upon user demand.</p>
<p>This wallet type is being actively phased out and discouraged from being used due to the backup hassle.</p>
</div>
</div>
</div>


            </div>
          </div>
        </div>
      </div>
        <div class="clearer"></div>
        </div>
      </div>
    </div>
<footer class="footer">
  <div class="footer-with-logo">
    <div class="footer-container">
      <a href="https://pandora.org/">
        <div class="footer-logo"></div>
      </a>

      <div class="footer-row ">
        <div class="donate">
          <div class="donate-row">
            <div>
              <span class="footer-title">Support Pandora.org:</span>
              <button onclick="openDonationModal()" class="donate-btn">Donate</button>
              <p class="donate-text">
                <a class="donate-link" href="pandora:3E8ociqZa9mZUSwGdSmAEMAoAxBK3FNDcd" target="_blank">3E8ociqZa9mZUSwGdSmAEMAoAxBK3FNDcd</a>
              </p>
            </div>
          </div>
        </div>
        
        <div class="footermenu">
          <div class="footermenu-item footermenu-introduction">
            <p class="footer-title">Introduction:</p>
            <ul class="footermenu-list">
              <li>
                <a href="https://pandora.org/en/pandora-for-individuals">Individuals</a>
              </li>
              <li>
                <a href="https://pandora.org/en/pandora-for-businesses">Businesses</a>
              </li>
              <li>
                <a href="../index.html">Developers</a>
              </li>
              <li>
                <a href="https://pandora.org/en/getting-started">Getting started</a>
              </li>
              <li>
                <a href="https://pandora.org/en/how-it-works">How it works</a>
              </li>
              <li>
                <a href="https://pandora.org/en/you-need-to-know">You need to know</a>
              </li>
                <a href="https://pandora.org/en/pandora-paper">White paper</a>
              </li>
            </ul>
          </div>
          
          <div class="footermenu-item footermenu-resources">
            <p class="footer-title">Resources:</p>
            <ul class="footermenu-list">
              <li>
                <a href="https://pandora.org/en/resources">Resources</a>
              <li>
                <a href="https://pandora.org/en/exchanges">Exchanges</a>
              </li>
              <li>
                <a href="https://pandora.org/en/community">Community</a>
              </li>
              <li>
                <a href="https://pandora.org/en/vocabulary">Vocabulary</a>
              </li>
              <li>
                <a href="https://pandora.org/en/events">Events</a>
              </li>
              <li>
                <a href="https://pandora.org/en/pandora-core/">Pandora Core</a>
              </li>
            </ul>
          </div>
          
          <div class="footermenu-item footermenu-participate">
            <p class="footer-title">Participate:</p>
            <ul class="footermenu-list">
              <li>
                <a href="https://pandora.org/en/support-pandora">Support Pandora</a>
              
              </li>
              <li>
                <a href="https://pandora.org/en/buy">Buy Pandora</a>
              </li>
              <li>
                <a href="https://pandora.org/en/full-node">Running a full node</a>
              </li>
              <li>
                <a href="https://pandora.org/en/development">Development</a>
              </li>
            </ul>
          </div>
          <div class="footermenu-item footermenu-other">
            <p class="footer-title">Other:</p>
            <a href="https://pandora.org/en/scams">Avoid Scams</a>
            <a href="https://pandora.org/en/legal">Legal</a>
            <a href="https://pandora.org/en/privacy">Privacy Policy</a>
            <a href="https://pandora.org/en/press">Press</a>
            <a href="https://pandora.org/en/about-us">About pandora.org</a>
            <a href="https://pandora.org/en/blog">Blog</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="copyright">
      <div>&copy; Copyright Pandora Project 2009-2020.</div>
  </div>
</footer>

<div id="donation-modal" style="display: none" class="donation-modal open">
  <div>
    <div>
      <div class="modal-close-btn" onclick="closeDonationModal()">×</div>
      <p class="modal-header-text">Donate to Pandora.org</p>
    </div>
    <p class="modal-subheader">Use this QR code or address below</p>
    <div style="text-align: center;">
      <div id="donation-qr-code" data-address="3E8ociqZa9mZUSwGdSmAEMAoAxBK3FNDcd"></div>
    </div>
    <div>
      <a
        class="donation-btc-address"
        href="pandora:3E8ociqZa9mZUSwGdSmAEMAoAxBK3FNDcd"
        target="_blank"
      >
        3E8ociqZa9mZUSwGdSmAEMAoAxBK3FNDcd
      </a>
    </div>
    <div style="overflow-y:hidden;text-align: center;">
      <div class="donation-buttons">
        <button type="button" class="donation-amount-btn" data-amount-usd="5">
          $5.00
          <div class="donation-amount-usd-in-btc">(... PDC)</div>
        </button>
        <button type="button" class="donation-amount-btn" data-amount-usd="25">
          $25.00
          <div class="donation-amount-usd-in-btc">(... PDC)</div>
        </button>
        <button type="button" class="donation-amount-btn" data-amount-usd="50">
          $50.00
          <div class="donation-amount-usd-in-btc">(... PDC)</div>
        </button>
      </div>

      <div class="donation-inputs">
        <input
          type="text"
          placeholder="Or custom amount? (PDC)"
          id="donation-input-amount-btc" class="donation-amount-input">
        <input
          type="text"
          placeholder="Or custom amount? (USD)"
          id="donation-input-amount-usd" class="donation-amount-input">
      </div>

      <div>
        <textarea
          class="donation-amount-input"
          id="donation-input-message"
          placeholder="Optional description (for your wallet)"></textarea>
      </div>
    </div>
  </div>
</div>
  </body>
</html>